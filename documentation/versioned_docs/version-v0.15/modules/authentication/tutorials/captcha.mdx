---
sidebar_label: 'Captcha'
sidebar_position: 5
---
# Captcha in Conduit

Conduit uses captcha as a middleware to improve security and prevent automated bot attacks.
Captcha can be enabled or disabled based on the configuration. Currently, Conduit supports only recaptcha v2 and hcaptcha providers.
In this tutorial, we will learn how to configure and use captcha in Conduit using the hcaptcha provider.

## Configuring captcha

To enable the captcha feature in Conduit, you need to patch the authentication configuration and set the **enabled** option to true. You can also specify which routes should have the captcha feature enabled using the routes option. The available options are **login, register, and oAuth2**.

You can also specify which platforms the captcha feature is available for using the **acceptablePlatform**  option. The available options are android and web.

:::caution
In order to continue to this tutorial you have to fully understand how [client validation](../../router/security#client-validation) works in conduit.
:::

To specify which captcha provider to use, you can set the provider option to either recaptcha or hcaptcha.

Here is an example configuration that enables the captcha feature for the login routes, using the hcaptcha provider and allowing the captcha feature to be used on both the web and android platforms
using hcaptcha provider.

- Navigate to the config tab in the admin panel.
- Go to Captcha configuration and configure the captcha mechanism.
- Fill the secret key section with the [testing hcaptcha secret key](https://docs.hcaptcha.com/#integration-testing-test-keys).

![Configuring captcha](/v0.15/modules/authentication/tutorials/configure_captcha.png)

##
## Testing the captcha

:::caution
To continue, disable the client validation through [router's configuration](../../router/config).
:::caution
The simplest approach to test the captcha middleware is by using the already generated [hcaptcha test keys](https://docs.hcaptcha.com/#integration-testing-test-keys).
Let's make a request to login by using the [local authentication strategy](./local).
``` bash title="Request"
curl --location --request POST 'http://localhost:3000/authentication/local' \
--header 'Content-Type: application/json' \
--data-raw '{
"email": "example@mail.com",
"password": "I_h4t3_p4ss_r3qu1r3m3nts",
"captchaToken": "10000000-aaaa-bbbb-cccc-000000000001",  //hcaptcha test token
}'
```

``` json title="Response"
{
  "userId": "6242f1bb10a09901827738fe",
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYyNDJmMWJiMTBhMDk5MDE4Mjc3MzhmZSIsImlhdCI6MTY0ODU1NDUyNywiZXhwIjoxNzM0OTU0NTI3fQ.Fjqa7ORBBF2giwG7OgiWr2HMgHDL7R6ddFq2E730Djc",
  "refreshToken": "BsKhe3ARhL/FfDfK1REphKkkqQaxRCj/LvvRHOg5wCXCBaUSOwafRHyFYIttaORY/NmHS7NAuT6+knBQegVOwQ=="
}
```

As you can see, the token was verified by the captcha middleware and you received some authentication tokens.
If the verification of the token fails, you will receive a proper error message.