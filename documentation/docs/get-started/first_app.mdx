# My First App

For understanding purposes, in this section I will try to show you how the Conduit App works using the **REST API**.
By the end of this tutorial you will be able to understand how Conduit communicates with a Front-End framework.<br />
Let's start to create an application with the help of the ReactJs framework. You can use whatever framework you want. But in this tutorial
React will be used.

## Prerequisites
To start this tutorial it is required to have some modules running. All you need to do is to install Conduit on your local machine<br />
and have some modules online.
The required modules which are needed to be online are: ***Core,Database,Email,Authentication***.<br />
:::caution
You need to configure Authentication and Email module.<br />
Do not forget to enable **local Authentication** while configuring Authentication module.<br />
:::

<Tabs>
<TabItem value="makefile" label="Makefile">
<details><summary>Prerequisites</summary>

``` bash
curl -L https://raw.githubusercontent.com/ConduitPlatform/Conduit/latest/docker/Makefile > Makefile
make create-network
make start-core
make start-database
make start-email
make start-authentication
```
</details>
</TabItem>
</Tabs>

## App Initialization

Let's create a directory called `conduit_app` and create a react-app in this folder.<br />
Make sure that the npm package manager is installed in your machine.<br />
```bash title="App Initialization"
npx create-react-app my-app
cd my-app
npm start
```

**Note**: ***CORE AND DATABASE MODULE SHOULD BE ONLINE***

## Client Login
The first thing you need to know is how an admin is logged in.So, let's make a react-component mapped to `/login` path.<br />
To start, install the React Router package. There are two different versions: a web version and a native version for use with React Native. You will install the web version.
In your terminal, use npm to install the package:
```
npm install react-router-dom
```

### Login Component
Once you installed the react-router you will need to make a Login Component.So, create a folder named `components` in the path `/my-app/src/components`.<br />
In this folder create a file named `Login.js`.<br />
Open a terminal and start the authentication module.If the authentication module isn't online then we can't proceed to any request.
See how to do this [here](../modules/authentication/get_started).

```bash title="Login Component creation"
mkdir /src/components
cd /src/components
nano Login.js
```
Copy this in your `Login.js` file and save it:
```tsx title="Login Component"
import React, {useState } from "react";
import '../css/Login.css'

async function loginUser(credentials) {
  return fetch('http://localhost:PORT/authentication/local', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'masterkey': 'somekey',
      'clientid': 'someclientid',
      'clientsecret': 'someclientsecret'
    },
    body: JSON.stringify(credentials)
  })
    .then(data => data.json())
 }

export default function Login() {
  const [email, setEmail] = useState();
  const [password, setPassword] = useState();
  const handleSubmit = async e => {
    e.preventDefault();
    const token = await loginUser({
      email,
      password
    });
    console.log(token);
  }

  return(
    <div className="login-wrapper">
      <form onSubmit={handleSubmit}>
      <label>
        <p>Email</p>
        <input type="text" onChange={e => setEmail(e.target.value)}/>
      </label>
      <label>
        <p>Password</p>
        <input type="password" onChange={e => setPassword(e.target.value)}/>
      </label>
      <div>
        <button type="submit">Submit</button>
      </div>
    </form>
    </div>
  )
}
```
As you can see, when you are submitting the credentials a POST request to `/admin/login` occurs.<br />
The response is the JSON Web Token that is used in every admin request.<br />
See [here](../router/get-started) for more.<br />

Navigate to the `/my-app/src/App.js` file.Paste this code in the `App.js` file:
```tsx title="React Routing"
import './App.css';
import Login from './components/Login';
import {
  BrowserRouter,
  Routes,
  Route,
  Link,
  Outlet
} from "react-router-dom";

function App() {
  return (
    <div className="wrapper">
      <h1>Admin Login</h1>
      <BrowserRouter>
        <Routes>
          <Route path="/login" element={<Login/>} />

        </Routes>
      </BrowserRouter>
    </div>
  );
}
export default App;
```
Open the browser and navigate to `/login`.
The following screenshot shows what it should be displayed if you navigate to the above url.<br />

![Login Component](/img/first_app/login_component.png)

As you can see,the JWT token is logged in the console.

## Making Client Requests

Once you have taken the Bearer Token you are ready to make requests. In order to understand how to make requests using React.<br />
I will give an example of how to do this.<br />
Let's make a React component which is responsible for Document creation.<br />
The route which is responsible for Schema Creation is mapped to `/database/schemaName` path.<br />

### Create Movie Schema

In order to create a schema you should have admin privileges.<br />
Checkout this [tutorial](../modules/database/tutorials/cinema_ticket_booking#movies_schema) to see how to create a schema by using the Admin Panel.<br />
Reading this tutorial you will understand that the idea is simple.There is a Movie Schema already created.<br />
So, we are going to operate on this schema doing some CRUD operations.

### Create Movie Document
To start understanding how a client uses the Conduit Service we are going to create a Movie Document!<br />
Let's start by creating a React Component that will be used to make a POST request to our database.<br />

Navigate to `/src/components` folder and create a file named `CreateMovie.js`.<br />
Paste this code in the file<br />

```tsx title="Create Movie Component"
import React, { useEffect, useState } from "react";
import '../css/Login.css'

async function createMovie(movie) {
  return fetch('http://localhost:PORT/database/Movies', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'clientid': 'someclientid',
      'clientsecret':'someclientsecret',
      'Authorization': 'Bearer sometoken'
    },
    body: JSON.stringify(movie)
  })
    .then(data => data.json())
 }

export default function CreateMovie() {
  const [name, setName] = useState();
  const [director, setDirector] = useState();
  const [releaseDate, setRelaseDate] = useState();
  const [duration, setDuration] = useState();

  const handleSubmit = async e => {
    e.preventDefault();
    const response = await createMovie({
      name,
      director,
      releaseDate,
      duration,
    });
    console.log(response);
  }

  return(
    <div className="login-wrapper">
      <form onSubmit={handleSubmit}>
      <label>
        <p>Name</p>
        <input type="text" onChange={e => setName(e.target.value)}/>
      </label>
      <label>
        <p>Director</p>
        <input type="text" onChange={e => setDirector(e.target.value)}/>
      </label>
      <label>
        <p>Duration</p>
        <input type="number" onChange={e => setDuration(e.target.value)}/>
      </label>
      <label>
        <p>Release Date</p>
        <input type="date" onChange={e => setRelaseDate(e.target.value)}/>
      </label>

      <div>
        <button type="submit">Submit</button>
      </div>
    </form>
    </div>
  )
}
```
Also, you need to map the component to a route using the react-router.<br />
Just add a route to the App.js file.The new App.js now is this:

```tsx title="App.js"
import './App.css';
import Login from './components/Login';
import CreateUser from './components/CreateMovie';
import {
  BrowserRouter,
  Routes,
  Route,
  Link,
  Outlet
} from "react-router-dom";

function App() {
  return (
    <div className="wrapper">
      <h1>Admin Login</h1>
      <BrowserRouter>
        <Routes>
          <Route path="/login" element={<Login/>} />
          <Route path="/movie" element={<CreateMovie/>} />

        </Routes>
      </BrowserRouter>
    </div>
  );
}
export default App;
```
Now we are ready to make a `POST` request to our database in order to create a movie.<br />
Navigate to `/movie` and fill the displayed inputs and press the submit button.<br />

![Create User](/img/first_app/create_movie.png)

As you can observe,the information of the created movie will be returned to you.<br />

### Get Movies

We've seen how to make a POST request to our database.Now, let's see how to make a GET request.<br />
For understanding purposes we will make a GET request to list all the registered movie documents.<br />
Let's make a Movie Component that will render the movie document information.<br />
Make a file named `GetMovies.js` and paste the following code:<br />

```tsx title="GetMovies Component"
import React, { useEffect, useState } from "react";
import '../css/Login.css'

async function getMovies() {

  return fetch('http://localhost:PORT/database/Movies', {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json',
      'clientid': 'someclientid',
      'clientsecret': 'someclientsecret',
      'Authorization': 'Bearer sometoken'
    },
  })
    .then(data => data.json())
 }

export default function GetMovies() {

  const [movies,setMovies] = useState([]);

  const handleSubmit = async e => {
    e.preventDefault();
    const response = await getMovies();
    console.log(response)
    setMovies(response.documents);
  }
  console.log(movies)
  return(
    <div className="login-wrapper">
      <form onSubmit={handleSubmit}>
        <button type="submit">GET MOVIES</button>
    </form>
    <div>
    <ul>
        {
          movies &&
          movies.map((movie) =>
            <li style={{
              display: "flex",
              gap: 2,
              flexDirection: "column",
              padding: 10

            }}>
              <div style= {{ fontWeight:"bold"}}>
                Name: {movie.name}
              </div>
              <div>
                Director: {movie.director}
              </div>
              <div>
                ReleaseDate: {movie.releaseDate}
              </div>


            </li>
          )
        }
        </ul>
    </div>
    </div>
  )
}
```

Also do not forget to map the component with a route.<br />
So, go to the `App.js` file and paste the following<br />

```tsx title="App.js"
import './App.css';
import Login from './components/Login';
import CreateMovie from './components/CreateMovie';
import GetMovies from './components/GetMovies';
import {
  BrowserRouter,
  Routes,
  Route,
  Link,
  Outlet
} from "react-router-dom";

function App() {
  return (
    <div className="wrapper">
      <h1>My App</h1>
      <BrowserRouter>
        <Routes>
          <Route path="/login" element={<Login/>} />
          <Route path="/movie" element={<CreateMovie/>} />
          <Route path="/movies" element={<GetMovies/>} />
        </Routes>
      </BrowserRouter>
    </div>
  );
}
export default App;
```

Now you are ready to retrieve the movies.Navigate to the `/movies` and click the **GET MOVIES** button.<br />
The registered movie documents should be displayed to you.<br />

![Get Movies](/img/first_app/get_movies.png)



