---
sidebar_label: 'REST'
sidebar_position: 2
---

# REST API

## Getting Started

Conduit exposes an HTTP server for you to perform REST requests.<br />
Said REST API is used for both user-level application requests and administrative requests.

### Performing Requests

Application routes are exposed under `CONDUIT_URL/moduleName/`.<br />
Example:<br />
The Database module accepts `GET` requests to `CONDUIT_URL/database/documents`.<br />
That's how your end-user applications would query for custom (CMS) schema documents.

Application routes make use of [Application Headers](./headers#headers-app).

Administrative routes are exposed under `CONDUIT_URL/moduleName/`<br />
Example:<br />
The Database module accepts `POST` requests to `CONDUIT_URL/admin/database/schemas`<br />
That's how Conduit's Admin Panel creates custom (CMS) schemas.

Administrative routes make use of [Administration Headers](./headers#headers-admin).

<details>
<summary>Request Examples</summary>

<!-- TODO: Probably worth splitting up examples dropdown into app/admin sections and reordering admin routes section above app routes one -->

Lets go through a couple examples, shall we?<br />
We'll be using curl for this in order to make sure everyone can follow along, but you can send your requests in any way you like.

We'll start by sending an administrative login request.<br />
Make sure you pass in the [`masterkey` header](headers#headers-admin-masterkey) along with your administrator credentials and send your data as raw JSON.<br />

``` bash title="Admin Login"
curl --location --request POST 'http://localhost:3000/admin/login' \
     --header 'masterkey: M4ST3RK3Y' \
     --header 'Content-Type: application/json' \
     --data-raw '{
        "username": "admin",
        "password": "admin"
     }'
```
```json title="Response"
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYyMmYxZGQ5NThkZDIwMDAxNzgwNWVmYyIsImlhdCI6MTY0NzM0MjMwMiwiZXhwIjoxNjQ3NDE0MzAyfQ.trHYfxt9Wf6ohgi5PWez-dZEDaQSBBR6wu2PINveQmI"
}
```

Great, that got us, uh, a quite long string of non-sense characters?<br />
Is that thing broken or what? Oh yeah, that's right, a token thing, I've watched people talk about these on YouTube.<br />
Does that mean I've got my very own NFT now?

Nah, but on the bright side, it should let you access your very own set of administrative routes!<br />
Let's put that token to use and send an authenticated admin request to the Database module.<br />
We pass it along as the Authentication header, prefixed by `Bearer `.
That one should return all of the schemas owned by Database or Authentication.

``` bash title="GET on /admin/database/schemas"
curl --location --request GET 'http://localhost:3000/admin/database/schemas/?enabled=true&owner=database,authentication' \
     --header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYyMmYxZGQ5NThkZDIwMDAxNzgwNWVmYyIsImlhdCI6MTY0NzM0MjMwMiwiZXhwIjoxNjQ3NDE0MzAyfQ.trHYfxt9Wf6ohgi5PWez-dZEDaQSBBR6wu2PINveQmI' \
     --header 'masterkey: M4ST3RK3Y'
```
```json title="Response"
{
  "schemas": [
    {
      "_id": "622f1dda58dd200017805f0e",
      "name": "AccessToken",
      "fields": {
        "_id": "ObjectId",
        "userId": {
          "type": "Relation",
          "model": "User",
          "required": true
        },
        "clientId": {
          "type": "String",
          "required": true
        },
        "token": {
          "type": "String",
          "required": true
        },
        "expiresOn": {
          "type": "Date",
          "required": true
        },
        "createdAt": "Date",
        "updatedAt": "Date"
      },
      "modelOptions": {
        "timestamps": true,
        "conduit": {
          "permissions": {
            "extendable": true,
            "canCreate": false,
            "canModify": "ExtensionOnly",
            "canDelete": false
          }
        }
      },
      "ownerModule": "authentication",
      "createdAt": "2022-03-14T10:50:02.239Z",
      "updatedAt": "2022-03-15T09:21:50.559Z",
      "extensions": [],
      "__v": 0
    },
    {
      ... more schemas ...
    }
  ],
  "count": 5
}
```

<!-- TODO: This explanation should probably be merged into router.mdx#request-types and headers.mdx and linked back to from here -->

Administrative requests usually expose or modify critical parts of your backend like listing private data and configuring your user authentication login policy.<br />
As such, they go through an authentication middleware to prevent non-administrators from being capable of performing them.

For most of your typical non-admin requests performed by your apps, you would perform a simple [application request](router/router.mdx#request-types-app) instead.<br />
These ones require a different set of headers to be passed along.<br />
A security client id and secret pair to be precise.<br />
You can get these by generating a security client for a platform of your choice.<br />

User routes additionally require that you pass along a user authentication token.<br />
Conduit is not limited to REST API
Lets send one last admin request to create an Android security client.

``` bash title="POST on /admin/security/client"
curl --location --request POST 'http://localhost:3000/admin/security/client/' \
     --header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYyMmYxZGQ5NThkZDIwMDAxNzgwNWVmYyIsImlhdCI6MTY0NzM0MjMwMiwiZXhwIjoxNjQ3NDE0MzAyfQ.trHYfxt9Wf6ohgi5PWez-dZEDaQSBBR6wu2PINveQmI' \
     --header 'masterkey: M4ST3RK3Y' \
     --header 'Content-Type: application/json' \
     --data-raw '{
         "platform": "ANDROID"
     }'
```
```json title="Response"
{
  "id": "623080eddbacba00172cd4f6",
  "clientId": "1c0d06679f837c3958fba2724b51dc",
  "clientSecret": "9ffd3a9041bff6aabff5fa81df8175c2406baaca6c417a165f5b66a9ad1c1e4408bc4aad895126ddc0ee007332aacf842f63ebc68eddc304a902a3f8867e9902",
  "platform": "ANDROID"
}
```

<!-- TODO:
Alright, stick with me now. We're almost there.<br />
Lets send our user request.
-->
</details>

-------------------------------------------------

## Swagger

Conduit's Router automatically generates OpenAPI schemas for all of your routes to be used by Swagger.<br />
This means your REST API is fully documented and even available for interaction through Swagger UI.<br />
You may always find locate your Swagger UI pages and grab the exported JSON files through the Admin Panel's home or module pages.<br />
<ins><strong>Notice:</strong> Make sure you grab the exported files <strong>after</strong> bringing up and configuring all of your target modules 
so that they include all the relevant routes and updated params.</ins>

<br /><br />
<div style={{textAlign: 'center'}}>

![Swagger Button from Home](/img/overview/home_topright_buttons.png)

</div>

Swagger UI pages are exposed under [/swagger](http://localhost:3000/swagger) and [/admin/swagger](http://localhost:3000/admin/swagger) by default.<br />
Oh, and you can grab your own *swagger.json* files from [/swagger.json](http://localhost:3000/swagger.json) and [/admin/swagger.json](http://localhost:3000/admin/swagger.json).<br />
You may import these directly in any API testing app of your choice to automatically generate your personalized request collection.

Just make sure you set up all of the required h[eaders](./headers) and point your `baseUrl` variable to your http server's path (eg `http://localhost:3000`).<br />
